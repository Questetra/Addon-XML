<?xml version="1.0" encoding="UTF-8"?>
<service-task-definition>
	<label>CheckTheUserIsInTheGroup</label>
	<label locale="ja">ユーザの指定組織への所属を判定</label>
	<summary>If the specified user is the leader of the specified group,this task returns "L". If he or she is one of the members of the group,it returns "M".If he or she doesn't belong to the group,it returns nothing.</summary>
	<summary locale="ja">指定したユーザが指定した組織のリーダであれば"L" を、メンバであれば"M" を、所属していなければ空を返します。</summary>
	<configs>
		<config name="userField" form-type="SELECT" select-data-type="QUSER" required="true">
			<label>I1.User Data</label>
			<label locale="ja">I1.ユーザデータ(指定:ユーザ型データ)</label>
		</config>
		<config name="groupField" form-type="SELECT" select-data-type="QGROUP" required="true">
			<label>I2.Group Data</label>
			<label locale="ja">I2.組織データ(指定:組織型データ)</label>
		</config>
		<config name="result" form-type="SELECT" select-data-type="STRING_TEXTFIELD" required="true">
			<label>O1.Result</label>
			<label locale="ja">O1.結果出力先(指定:単一行文字型データ)</label>
		</config>
	</configs>
	<script><![CDATA[
main();
function main(){
	//set group data from I2
	var groupIs = engine.findDataByNumber(configs.get("groupField"));
	//set user data from I2
	var userIs = engine.findDataByNumber(configs.get("userField"));
	var result = "";
	if (check(true,userIs,groupIs)) {
		result = "L";
	}else if (check(false,userIs,groupIs)) {
		result = "M";
	}
	//set result to O1
	engine.setDataByNumber(configs.get("result"),result);
}
//check whether the user is the leader or a member of the group
function check(LM,user,group){
	var temp;
	var list = quserDao.findByQgroupAndPosition(group,LM);
	for (var i = 0;i<list.size();i++){
		temp = list.get(i);
		if(user.getId().equals(temp.getId())){
			return true;
		}
	}
}
]]>
</script>
<icon>iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEkklEQVRYR8WXXUyTZxTHf0WsyGf5
2gIDFEQwIAIuhAvi5AIDm44gyYwBjWUxKTHGMb0zyrYbE2N0GDVbL0SMjIUtC3CxkUxZ0GxDRcNH
IE6YAiKJG7G0ILiVhnd53trS9n1bykbcSQhNn/Pxf845//OcavifRbOs+EbKgO1I5KBBB+S8su9F
wowG8b+Tatr89bs0gCvosPIRUANyUH/EDNSh5TxViM9exTeAL9ATwOfLCOwZSASvwkCrNwTeAXxJ
HRr55ishdRj4WM2ROgAjDcCBlYjs9CHRQDVVnj6VAHzcvDCukCNZR8iKyiI0MBTtKi22BRtztjmG
LEM0Djdybfiad9wS56mWe8kp7gDsNb+i5qH93XYK4wsJWhXkNYAA0/O8h4M3D9Jv6vemt9u1JxYB
2Lt9xLPhtsZspbmomdTwVL8rMvnXJDW/1tD0e5OajRktyQ52LAIw8inwiafF8N7hZQV32Jv+NlHy
Qwndk91qID7DIMfDFYCgTISrtkh7SWKJ6s0nZie48+cdwrXhFLxZwNrAtQq9walBNn+7WT0LBiIX
AdgnXIurpmi49vfaVWs+/mKcyp8qqX27lh3f7+B++X1EqTxFQuJE9wlO9ZxSAyH3gj0DKp3fVtxG
6bpS1duf6TtDXHAc+zbu49ncM2KCYggMCFTV7X3eS+53ucqzV4ywAzDSKc94F3m09xEp4SkKw/mF
eaKvRtOxq4O82LwlG3PaOk1Eg1tlHTY3MVDoADAKrHP1ZjpgInKNXCaniMZ6PP2YvJY8Ot/vZEP4
BkZnRtkStQWbZGNsZozMqEy0AVqnzYK0gK5Bx8z8jCfYXgzkOgBInqezH84SHBjs9nXXH120jLYg
SlC/vZ5Nuk0y1UQDWqwW9Gl6ooOiSYtIc7Mr/7FctlOIAY1XAFP6KXRa5ePXOtrKuf5z3Cq9JfsT
GUj+OpmBDwbIjMxULUniV4k8nX3qE4CiBOOV4ySEJCiMjnYdlUdxVbp9rIsRnN6czu2y2+S/kc/I
zAjJYclOOzGmQ+pD1Jqwj2pyvDbh9Z3XKXqrSDY0W808ND8kKTSJ+MZ4nlQ8wbpgldN++bfLbIvb
xsWBixzLPoYGDWXrBavt8sD8gIxvMtQy49KEKjTcv3G/XGdBL4eT4oRiTuefJjs6m5e2l/K8F0wR
NBw0DcqgRHZWB6x2Brw0eInDvxxWy4D8MDkyoBhEwuLu7rtOqgn6uTpWLbbHl2JgJTUleVN1GURC
xSivTm6EFfS6sesGsUGx/sRz0xEZOvTzIRqGxGqhEAsG+3q35GNUkVrBhYILRK2J8huECH62/ywn
7530ZqPyGNmfY8EGxdgSj43xHSMZkRlyk/kSkfbae7Xebi5MLWhZr3yOxZGPhUQcH889zp6UPTLN
wrRhTjDixmMvxuiY6FBvOHfEXhYSh9LKLqOeyXKm3nHw+pZSuIoBvSei17WWK27uOwOOU/uiInik
+p76QQsLoP93P0wc3u3sEKu0+PMXiAgsfprV/befZp5XFBmRKERDDhI6NGTLKhJ9aDAj0YuGTl83
9r8H/MjvSqj8A6Z/jzDhuf3+AAAAAElFTkSuQmCC</icon>
</service-task-definition>
