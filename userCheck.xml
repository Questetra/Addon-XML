<?xml version="1.0" encoding="UTF-8"?>
<service-task-definition>
	<label>UserCheck</label>
	<summary>指定したユーザが指定した組織のリーダであれば"L" を、メンバであれば"M" を、所属していなければ空を返します。</summary>
	<configs>
		<config name="userField" form-type="SELECT" select-data-type="QUSER" required="true">
			<label>User Data</label>
			<label locale="ja">ユーザーデータ</label>
		</config>
		<config name="groupField" form-type="SELECT" select-data-type="QGROUP" required="true">
			<label>Group Data</label>
			<label locale="ja">組織データ</label>
		</config>
		<config name="result" form-type="SELECT" select-data-type="STRING" required="true">
			<label>Result</label>
			<label locale="ja">結果出力先</label>
		</config>
	</configs>
	<script><![CDATA[
var user = engine.findDataByNumber(configs.get("userField"));
var group = engine.findDataByNumber(configs.get("groupField"));
var listL = quserDao.findByQgroupAndPosition(group,true);
var result = "";
var temp = ""
for (var i = 0;i<listL.size();i++){
temp = listL.get(i);
if(user.getId() == temp.getId()){
result = "L";
}
}

var listM = quserDao.findByQgroupAndPosition(group,false);

for (var j = 0; j < listM.size() ; j++){
temp = listM.get(j);
if(user.getId() == temp.getId()){
result = "M";
}
}
engine.setDataByNumber(configs.get("result"),result);

]]>
</script>
</service-task-definition>