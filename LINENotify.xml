<?xml version="1.0" encoding="UTF-8"?>
<service-task-definition>
	<label>Post message through LINE Notify</label>
	<label locale="ja">LINE Notifyでメッセージ投稿</label>
	<summary>Post message to your LINE Group through LINE Notify.In advance you have to get a personal access token.</summary>
	<summary locale="ja">LINE Notifyを通してLINEグループにメッセージを投稿します。事前にパーソナルアクセストークンを取得してください。</summary>
	<configs>
		<config name="token" form-type="TEXTFIELD" required="true">
		<label>C1.access token</label>
		<label locale="ja">C1.アクセストークン</label>
		</config>
		<config name="Message" form-type="SELECT" select-data-type="STRING" required="true">
		<label>I1.Text Message</label>
		<label locale="ja">I1.テキスト</label>
		</config>
	</configs>
	<script><![CDATA[
var token = configs.get("token");
var message = engine.findDataByNumber(configs.get("Message"));
var log = "";
var response = httpClient.begin()
  .bearer(token)
  .multipart("message", message)
  .post('https://notify-api.line.me/api/notify');
var responseText = response.getResponseAsString();
var json = JSON.parse(responseText);
if (response.getStatusCode() != 200) {
  log = "status code is not 200. " + response.getStatusCode() + ".\n" +"Message:" + json["message"] ;
}

engine.log(log);
]]>
</script>
</service-task-definition>